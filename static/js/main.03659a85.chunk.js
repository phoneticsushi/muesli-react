(this.webpackJsonpmuesli=this.webpackJsonpmuesli||[]).push([[0],{103:function(e,n,t){"use strict";t.r(n);var a=t(0),c=t.n(a),r=t(27),o=t.n(r),u=(t(98),t(74)),l=t(155),i=t(147),s=(t(64),t(14)),d=t(11),b=t(156),j=t(154),f=t(146),m=t(149),h=t(148),O=t(157),v=t(152),g=t(151),p=t(41),x=t(46),y=t(153),V=t(2),C=["enabled","enableText","disableText"];var k=function(e){e.enabled,e.enableText,e.disableText;var n=Object(x.a)(e,C);return Object(V.jsx)(y.a,Object(p.a)(Object(p.a)({color:e.enabled?"error":"success"},n),{},{children:e.enabled?e.disableText||"Disable":e.enableText||"Enable"}))},w=t(71),P=t.n(w),S=t(23);var T=function(e){var n,t=Object(S.a)(),c=Object(a.useRef)(),r=Object(a.useRef)();function o(){var e;null===(e=r.current)||void 0===e||e.play()}return Object(a.useEffect)((function(){return r.current=P.a.create({container:c.current,responsive:!0}),function(){r.current.destroy(),r.current=null}}),[]),Object(a.useEffect)((function(){var e,n;null===(e=r.current)||void 0===e||e.setWaveColor(t.palette.primary.dark),null===(n=r.current)||void 0===n||n.setProgressColor(t.palette.secondary.dark)}),[t.palette.primary.dark,t.palette.secondary.dark]),Object(a.useEffect)((function(){var n,t;e.autoplay?null===(n=r.current)||void 0===n||n.on("ready",o):null===(t=r.current)||void 0===t||t.un("ready")}),[e.autoplay]),Object(a.useEffect)((function(){var n,t;e.audioPath?null===(n=r.current)||void 0===n||n.load(e.audioPath):null===(t=r.current)||void 0===t||t.empty()}),[e.audioPath]),Object(a.useEffect)((function(){var n,t;e.loop?null===(n=r.current)||void 0===n||n.on("finish",o):null===(t=r.current)||void 0===t||t.un("finish")}),[e.loop]),Object(V.jsxs)(b.a,{children:[Object(V.jsxs)("h2",{children:["AudioDisplay WIP: ",e.name||"No Name"]}),Object(V.jsxs)("p",{children:["Audio Path: ",e.audioPath]}),Object(V.jsxs)("p",{children:["Audio Duration: ",1e3*(null===(n=r.current)||void 0===n?void 0:n.getDuration()),"ms"]}),Object(V.jsx)("div",{ref:c}),Object(V.jsx)(y.a,{onClick:o,children:"Play Audio"}),Object(V.jsx)(y.a,{onClick:function(){var e;null===(e=r.current)||void 0===e||e.pause()},children:"Pause Audio"})]})},A=t(75),D=t(72),R=t.n(D);function E(e,n,t,a){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:function(){},o=new AnalyserNode(e,{minDecibels:a});n.connect(o);var u=new Uint8Array(o.frequencyBinCount),l=performance.now(),i=!1;function s(){var e=performance.now();o.getByteFrequencyData(u),u.some((function(e){return e}))&&(i||(c(),i=!0,console.log("Detected Audio")),l=e),i&&e-l>t&&(r(),i=!1,console.log("Detected Silence"))}var d=setInterval(s,100);return function(){clearInterval(d),console.log("Ran cleanup function for silence detection")}}var N=function(e,n,t,a){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:-60,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:500,o=100,u=(t-2*r)/o,l=a/o,i=new AudioContext,s=i.createMediaStreamSource(e),d=new DelayNode(i,{delayTime:r/1e3,maxDelayTime:r/1e3}),b=i.createMediaStreamDestination();s.connect(d).connect(b);var j=new MediaRecorder(b.stream),f=[];j.ondataavailable=function(e){f.push(e.data)},j.onstop=function(e){if(f.length<=l)console.log("Skipping Audio conversion as number of chunks",f.length,"<=",l);else{console.log("Converting Audio as number of chunks",f.length,">",l,"- trimming",u);var t=new Blob(f.slice(0,f.length-u),{type:"audio/ogg; codecs=opus"}),a={name:R()({exactly:1,wordsPerString:2,separator:"-"})[0],url:window.URL.createObjectURL(t)};console.log("Generated clip",a),n(a)}f=[]};var m=E(i,s,t,c,(function(){return j.start(o)}),(function(){return j.stop()}));return function(){m(),"recording"===j.state&&j.stop(),i.close(),e.getTracks().forEach((function(e){return e.stop()})),console.log("Ran cleanup function for recording routine")}},B=["minValue","maxValue","onChange"];var F=function(e){var n=Object(a.useState)(!1),t=Object(d.a)(n,2),c=t[0],r=t[1];e.minValue,e.maxValue,e.onChange;var o=Object(x.a)(e,B);return Object(V.jsx)(h.a,Object(p.a)({error:c,onChange:function(n){return function(n){var t=Number(n.target.value);!n.target.value.trim()||isNaN(t)||e.minValue&&t<e.minValue||e.maxValue&&t>e.maxValue?r(!0):(r(!1),e.onChange&&e.onChange(t))}(n)},helperText:c?e.minValue&&e.maxValue?"Value must be a number between ".concat(e.minValue," and ").concat(e.maxValue):e.minValue?"Value must be a number at least ".concat(e.minValue):e.maxValue?"Value must be a number at most ".concat(e.maxValue):"Value must be a number":void 0},o))};var I=function(e){var n=Object(a.useRef)(),t=Object(a.useState)(),c=Object(d.a)(t,2),r=c[0],o=c[1],u=Object(a.useState)(1e3),l=Object(d.a)(u,2),i=l[0],p=l[1],x=Object(a.useState)(2e3),y=Object(d.a)(x,2),C=y[0],w=y[1];Object(A.a)("r",(function(e){e.altKey&&E()}));var P=Object(a.useState)([]),S=Object(d.a)(P,2),D=S[0],R=S[1];function E(){r?(n.current(),n.current=null,o(!1)):(navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((function(e){n.current=N(e,B,C,i)})),o(!0))}function B(e){R((function(n){return[e].concat(Object(s.a)(n))}))}var I=Object(a.useState)(!1),M=Object(d.a)(I,2),L=M[0],U=M[1],W=Object(a.useState)(!1),q=Object(d.a)(W,2),J=q[0],G=q[1];return Object(V.jsxs)(b.a,{className:"App",children:[Object(V.jsx)("h2",{children:'Dictaphone WIP "Pumblechook"'}),Object(V.jsxs)(j.a,{container:!0,spacing:2,children:[Object(V.jsx)(j.a,{item:!0,id:"controls",xs:5,sm:4,md:3,lg:2,children:Object(V.jsxs)(f.a,{spacing:2,children:[Object(V.jsx)(m.a,{title:"Toggle with Alt-R",arrow:!0,children:Object(V.jsx)(k,{enabled:r,enableText:"Start Recording",disableText:"Stop Recording",onClick:E})}),Object(V.jsx)(h.a,{label:"Custom Audio File Path",placeholder:"(debug only)",onChange:function(e){return R([{url:e.target.value}])}}),Object(V.jsx)(F,{disabled:r,label:"Cut clip when silent for",placeholder:"Time in seconds...",defaultValue:C/1e3,minValue:1,maxValue:15,onChange:function(e){return w(1e3*e)}}),Object(V.jsx)(F,{disabled:r,label:"Discard clips shorter than",placeholder:"Time in seconds...",defaultValue:i/1e3,minValue:0,maxValue:5,onChange:function(e){return p(1e3*e)}}),Object(V.jsxs)(O.a,{children:[Object(V.jsx)(v.a,{control:Object(V.jsx)(g.a,{onChange:function(e){return U(e.target.checked)}}),label:"Loop"}),Object(V.jsx)(v.a,{control:Object(V.jsx)(g.a,{onChange:function(e){return G(e.target.checked)}}),label:"Autoplay"})]})]})}),Object(V.jsx)(j.a,{item:!0,id:"clips",xs:7,sm:8,md:9,lg:10,children:Object(V.jsx)(f.a,{spacing:2,children:D.map((function(e){return Object(V.jsx)(T,{name:e.name,audioPath:e.url,autoplay:J,loop:L},e.url)}))})})]})]})};var M=function(){var e=Object(u.a)({palette:{mode:"dark",background:{default:"#10051a"}},components:{MuiButton:{defaultProps:{variant:"outlined"}}}});return Object(V.jsxs)(l.a,{theme:e,children:[Object(V.jsx)(i.a,{}),Object(V.jsx)(I,{})]})},L=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,158)).then((function(n){var t=n.getCLS,a=n.getFID,c=n.getFCP,r=n.getLCP,o=n.getTTFB;t(e),a(e),c(e),r(e),o(e)}))};o.a.render(Object(V.jsx)(c.a.StrictMode,{children:Object(V.jsx)(M,{})}),document.getElementById("root")),L()},64:function(e,n,t){},98:function(e,n,t){}},[[103,1,2]]]);
//# sourceMappingURL=main.03659a85.chunk.js.map