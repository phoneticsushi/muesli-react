(this.webpackJsonpmuesli=this.webpackJsonpmuesli||[]).push([[0],{100:function(e,n,t){},105:function(e,n,t){"use strict";t.r(n);var a=t(0),c=t.n(a),r=t(29),o=t.n(r),u=(t(100),t(75)),i=t(155),l=t(148),s=(t(65),t(14)),d=t(13),b=t(156),j=t(154),f=t(147),m=t(150),h=t(157),O=t(149),p=t(158),v=t(160),g=t(161),x=t(152),y=t(42),V=t(47),C=t(153),S=t(2),P=["enabled","enableText","disableText"];var T=function(e){e.enabled,e.enableText,e.disableText;var n=Object(V.a)(e,P);return Object(S.jsx)(C.a,Object(y.a)(Object(y.a)({color:e.enabled?"error":"success"},n),{},{children:e.enabled?e.disableText||"Disable":e.enableText||"Enable"}))},k=t(72),w=t.n(k),A=t(22);var D=function(e){var n,t=Object(A.a)(),c=Object(a.useRef)(),r=Object(a.useRef)();function o(){var e;null===(e=r.current)||void 0===e||e.play()}return Object(a.useEffect)((function(){return r.current=w.a.create({container:c.current,responsive:!0}),function(){r.current.destroy(),r.current=null}}),[]),Object(a.useEffect)((function(){var e,n;null===(e=r.current)||void 0===e||e.setWaveColor(t.palette.primary.dark),null===(n=r.current)||void 0===n||n.setProgressColor(t.palette.secondary.dark)}),[t.palette.primary.dark,t.palette.secondary.dark]),Object(a.useEffect)((function(){var n,t;e.autoplay?null===(n=r.current)||void 0===n||n.on("ready",o):null===(t=r.current)||void 0===t||t.un("ready")}),[e.autoplay]),Object(a.useEffect)((function(){var n,t;e.audioPath?null===(n=r.current)||void 0===n||n.load(e.audioPath):null===(t=r.current)||void 0===t||t.empty()}),[e.audioPath]),Object(a.useEffect)((function(){var n,t;e.loop?null===(n=r.current)||void 0===n||n.on("finish",o):null===(t=r.current)||void 0===t||t.un("finish")}),[e.loop]),Object(S.jsxs)(b.a,{children:[Object(S.jsxs)("h2",{children:["AudioDisplay WIP: ",e.name||"No Name"]}),Object(S.jsxs)("p",{children:["Audio Path: ",e.audioPath]}),Object(S.jsxs)("p",{children:["Audio Duration: ",1e3*(null===(n=r.current)||void 0===n?void 0:n.getDuration()),"ms"]}),Object(S.jsx)("div",{ref:c}),Object(S.jsx)(C.a,{onClick:o,children:"Play Audio"}),Object(S.jsx)(C.a,{onClick:function(){var e;null===(e=r.current)||void 0===e||e.pause()},children:"Pause Audio"})]})},R=t(76),M=t(73),E=t.n(M);function N(e,n,t,a){var c=arguments.length>4&&void 0!==arguments[4]?arguments[4]:function(){},r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:function(e){},o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:function(){},u=new AnalyserNode(e,{minDecibels:a});n.connect(u);var i=new Uint8Array(u.frequencyBinCount),l=performance.now(),s=!1;function d(){var e=performance.now();u.getByteFrequencyData(i),i.some((function(e){return e}))&&(s||(c(),s=!0,console.log("Detected Audio")),l=e);var n=e-l;r(n),s&&n>t&&(o(),s=!1,console.log("Detected Silence"))}var b=setInterval(d,100);return function(){clearInterval(b),console.log("Ran cleanup function for silence detection")}}var I=function(e,n,t,a,c){var r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:-60,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:500,u=100,i=a-2*o,l=i/u,s=c/u,d=new AudioContext,b=d.createMediaStreamSource(e),j=new DelayNode(d,{delayTime:o/1e3,maxDelayTime:o/1e3}),f=d.createMediaStreamDestination();b.connect(j).connect(f);var m=new MediaRecorder(f.stream),h=[];m.ondataavailable=function(e){h.push(e.data)},m.onstop=function(e){if(h.length<=s)console.log("Skipping Audio conversion as number of chunks",h.length,"<=",s);else{console.log("Converting Audio as number of chunks",h.length,">",s,"- trimming",l);var n=new Blob(h.slice(0,h.length-l),{type:"audio/ogg; codecs=opus"}),a={name:E()({exactly:1,wordsPerString:2,separator:"-"})[0],url:window.URL.createObjectURL(n)};console.log("Generated clip",a),t(a)}h=[]};var O=N(d,b,a,r,(function(){return m.start(u)}),(function(e){return n(Math.max(a-(e+o),0))}),(function(){return m.stop()}));return function(){O(),"recording"===m.state&&m.stop(),d.close(),e.getTracks().forEach((function(e){return e.stop()})),console.log("Ran cleanup function for recording routine")}},B=["minValue","maxValue","onChange"];var F=function(e){var n=Object(a.useState)(!1),t=Object(d.a)(n,2),c=t[0],r=t[1];e.minValue,e.maxValue,e.onChange;var o=Object(V.a)(e,B);return Object(S.jsx)(O.a,Object(y.a)({error:c,onChange:function(n){return function(n){var t=Number(n.target.value);!n.target.value.trim()||isNaN(t)||e.minValue&&t<e.minValue||e.maxValue&&t>e.maxValue?r(!0):(r(!1),e.onChange&&e.onChange(t))}(n)},helperText:c?e.minValue&&e.maxValue?"Value must be a number between ".concat(e.minValue," and ").concat(e.maxValue):e.minValue?"Value must be a number at least ".concat(e.minValue):e.maxValue?"Value must be a number at most ".concat(e.maxValue):"Value must be a number":void 0},o))};var L=function(e){var n=Object(a.useRef)(),t=Object(a.useState)(),c=Object(d.a)(t,2),r=c[0],o=c[1],u=Object(a.useState)(),i=Object(d.a)(u,2),l=i[0],y=i[1],V=Object(a.useState)(1e3),C=Object(d.a)(V,2),P=C[0],k=C[1],w=Object(a.useState)(3e3),A=Object(d.a)(w,2),M=A[0],E=A[1];Object(R.a)("r",(function(e){e.altKey&&q()}));var N=Object(a.useState)([]),B=Object(d.a)(N,2),L=B[0],U=B[1];function q(){r?(n.current(),n.current=null,o(!1),y(0)):(navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((function(e){n.current=I(e,y,J,M,P)})),o(!0))}function J(e){U((function(n){return[e].concat(Object(s.a)(n))}))}var W=Object(a.useState)(!1),G=Object(d.a)(W,2),H=G[0],K=G[1],z=Object(a.useState)(!1),Q=Object(d.a)(z,2),X=Q[0],Y=Q[1];return Object(S.jsxs)(b.a,{className:"App",children:[Object(S.jsx)("h2",{children:"Muesli Practice Helper"}),Object(S.jsxs)(j.a,{container:!0,spacing:2,children:[Object(S.jsx)(j.a,{item:!0,id:"controls",xs:5,sm:4,md:3,lg:2,children:Object(S.jsxs)(f.a,{spacing:2,children:[Object(S.jsx)(m.a,{title:"Toggle with Alt-R",arrow:!0,children:Object(S.jsx)(T,{enabled:r,enableText:"Start Recording",disableText:"Stop Recording",onClick:q})}),Object(S.jsxs)("p",{children:["Mic Open: ",String(r)]}),Object(S.jsxs)("p",{children:["Time until Clip: ",String(Math.floor(l/100)/10)," seconds"]}),Object(S.jsx)(h.a,{variant:"determinate",value:l/M*100}),Object(S.jsx)(O.a,{label:"Custom Audio File Path",placeholder:"(debug only)",onChange:function(e){return U([{url:e.target.value}])}}),Object(S.jsx)(F,{disabled:r,label:"Cut clip when silent for",placeholder:"Time...",InputProps:{endAdornment:Object(S.jsx)(p.a,{position:"end",children:"s"})},defaultValue:M/1e3,minValue:1,maxValue:15,onChange:function(e){return E(1e3*e)}}),Object(S.jsx)(F,{disabled:r,label:"Discard clips shorter than",placeholder:"Time...",InputProps:{endAdornment:Object(S.jsx)(p.a,{position:"end",children:"s"})},defaultValue:P/1e3,minValue:0,maxValue:5,onChange:function(e){return k(1e3*e)}}),Object(S.jsxs)(v.a,{children:[Object(S.jsx)(g.a,{control:Object(S.jsx)(x.a,{onChange:function(e){return K(e.target.checked)}}),label:"Loop"}),Object(S.jsx)(g.a,{control:Object(S.jsx)(x.a,{onChange:function(e){return Y(e.target.checked)}}),label:"Autoplay"})]})]})}),Object(S.jsx)(j.a,{item:!0,id:"clips",xs:7,sm:8,md:9,lg:10,children:Object(S.jsx)(f.a,{spacing:2,children:L.map((function(e){return Object(S.jsx)(D,{name:e.name,audioPath:e.url,autoplay:X,loop:H},e.url)}))})})]})]})};var U=function(){var e=Object(u.a)({palette:{mode:"dark",background:{default:"#10051a"}},components:{MuiButton:{defaultProps:{variant:"outlined"}}}});return Object(S.jsxs)(i.a,{theme:e,children:[Object(S.jsx)(l.a,{}),Object(S.jsx)(L,{})]})},q=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,162)).then((function(n){var t=n.getCLS,a=n.getFID,c=n.getFCP,r=n.getLCP,o=n.getTTFB;t(e),a(e),c(e),r(e),o(e)}))};o.a.render(Object(S.jsx)(c.a.StrictMode,{children:Object(S.jsx)(U,{})}),document.getElementById("root")),q()},65:function(e,n,t){}},[[105,1,2]]]);
//# sourceMappingURL=main.79340aea.chunk.js.map